<div class="container loading" *ngIf="loading">
  <img src="assets/imgs/loadinggif1.gif" class="loadinggif">
  <div class="display-4" style="font-size: x-large;">
    Loading... Please Wait
  </div>
</div>
<div class="card mt-5 mb-5 ml-5 mr-5" >
  <div class="card-header">
    <h1 class="display-4" style="font-size: 40px;">Bill No. {{currBill.bill.num}} of year {{currBill.bill.date|date:'yyyy'}}</h1>
  </div>
  <div class="card-body" >
    <div>
      <h5>Party Name : <small>{{currBill.party_name}}</small></h5>
    </div>
    <div class="row">
      <div class="row col-4">
        <div class="col-5">
          <h5>Bill No</h5>
          <p class="amtcss">{{currBill.bill.num}}</p>
        </div>
        <div class="col-6">
          <h5>Bill Date</h5>
          <p class="amtcss">{{currBill.bill.date|date:'dd/MM/yyyy'}}</p>
        </div>
        <div class="col-1"></div>
      </div>
  
      <div class="row col-4">
        <div class="col-5">
          <h5>DC No</h5>
          <p class="amtcss">{{currBill.dc.num}}</p>
        </div>
        <div class="col-6">
          <h5>DC Date</h5>
          <p class="amtcss">{{currBill.dc.date|date:'dd/MM/yyyy'}}</p> 
        </div>
        <div class="col-1"></div>
      </div>
  
      <div class="row col-4">
        <div class="col-5">
          <h5>PO No</h5>
          <p class="amtcss">{{currBill.po.num}}</p>
        </div>
        <div class="col-6">
          <h5>PO Date</h5>
          <p class="amtcss">{{currBill.po.date|date:'dd/MM/yyyy'}}</p> 
        </div>
        <div class="col-1"></div>
      </div>
    </div>
    <hr>
    <div *ngIf="currBill.cancelled">
      <h6>This Bill was Cancelled</h6>
      <p>
        <span class="h6">Reason for Cancellation: </span>
        {{currBill.cancel_reason}}
      </p>
    </div>
    <hr>
    <div>
      <table class="table table-stripped">
        <thead class="thead-dark">
          <tr>
            <th scope="col">#</th>
            <th scope="col">Description</th>
            <th scope="col">Qty</th>
            <th scope="col">Rate</th>
            <th scope="col">Amt</th>
          </tr>
        </thead>
        <tbody *ngFor="let item of currBill.items;let i = index;" class="border-left border-right">
          <tr>
            <th scope="row" style="width: 10%;">{{i+1}}</th>
            <td class="tdcss" style="width: 40%;">{{item.description}}</td>
            <td style="width: 20%;">{{item.qty}}</td>
            <td style="width: 20%;">{{item.rate}}</td>
            <td>{{item.amt}}</td>
          </tr>
        </tbody>
        <tbody class="border">
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td class="h4 border">Total Amount</td>
            <td class="border">{{currBill.tot_amt}}</td>
          </tr>
          <tr *ngIf="discountGiven">
            <td></td>
            <td></td>
            <td></td>
            <td class="h4 border">Discounted Price</td>
            <td class="border">{{currBill.disctotal}}</td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td class="h4 border">Round Off</td>
            <td class="border">
              <span *ngIf="currBill.roundoff>0">+</span>
              {{currBill.roundoff}}
            </td>
          </tr>
          <tr class="border-bottom">
            <td></td>
            <td></td>
            <td></td>
            <td class="h4 border">Grand Total</td>
            <td class="border">{{currBill.grand_total}}</td>
          </tr>
        </tbody>
      </table>
      
      <div class="container mt-4 mb-5" *ngIf="!cancelMenu && !currBill.cancelled">
        <div class="btn-group" style="width:100%;">
          <button type="button" class="btn btn-dark btn-lg" style="width: 50%;" (click)="printBill()">
            <i class="fa fa-print"></i>
            Print Bill
          </button>
          <button type="button" class="btn btn-outline-danger btn-lg" style="width: 50%;" (click)="toggleCancelMenu()">
            <i class="fa fa-times"></i>
            Cancel Bill
          </button>
        </div>
      </div>
  
      <div class="container mt-4 mb-5" *ngIf="cancelMenu">
        <div [formGroup]="cancelForm" class="form-group">
          <label for="cancel_reason">Reason for Cancelling Bill</label>
          <textarea name="cancel_reason" id="cancel_reason" formControlName="cancel_reason" class="form-control"></textarea>
        </div>
        <div class="btn-group" style="width:100%;">
          <button type="button" class="btn btn-outline-danger btn-lg" style="width: 50%;" (click)="cancelBill()">
            <i class="fa fa-print"></i>
            Confirm Operation
          </button>
          <button type="button" class="btn btn-dark btn-lg" style="width: 50%;" (click)="toggleCancelMenu()">
            <i class="fa fa-times"></i>
            Cancel Operation
          </button>
        </div>
      </div>
    </div>
  </div>
</div>